<mat-drawer-container autosize>
  <mat-drawer #drawer class="drawer-container" position="end" mode="over">
    <div *ngIf="stockService.stockSelected">
      <div class="active-title">
        <div class="stock-info">
          <h1>{{ stockService.stockSelected.active }}</h1>
          <p>{{ stockService.stockSelected.description }}</p>
        </div>
        <div class="value-info">
          <mat-icon
            *ngIf="stockService.stockSelected.cashReturn > 0"
            class="icon positive"
          >
            arrow_upward
          </mat-icon>
          <mat-icon
            *ngIf="stockService.stockSelected.cashReturn < 0"
            class="icon negative"
          >
            arrow_downward
          </mat-icon>
          <div class="value-container">
            <span
              class="value"
              [ngClass]="
                stockService.stockSelected.cashReturn > 0
                  ? 'positive'
                  : 'negative'
              "
            >
              {{
                formatter.formatCurrency(stockService.stockSelected.cashReturn)
              }}
            </span>
            <span
              class="value"
              [ngClass]="
                stockService.stockSelected.profitability > 0
                  ? 'positive'
                  : 'negative'
              "
            >
              {{
                formatter.formatPercent(
                  stockService.stockSelected.profitability
                )
              }}
            </span>
          </div>
        </div>
      </div>

      <div class="stock-values">
        <h2>Valor Patrimonial</h2>

        <mat-form-field>
          <mat-label>Quantidade</mat-label>
          <input
            type="number"
            matInput
            [(ngModel)]="stockService.stockSelected.amount"
            name="amount"
          />
        </mat-form-field>

        <mat-form-field>
          <mat-label>Média de compra</mat-label>
          <input
            matInput
            currencyMask
            [(ngModel)]="stockService.stockSelected.averagePurchase"
            name="averagePurchase"
          />
        </mat-form-field>

        <mat-form-field>
          <mat-label>Valor de compra</mat-label>
          <input
            matInput
            currencyMask
            [(ngModel)]="stockService.stockSelected.purchaseValue"
            name="purchaseValue"
          />
        </mat-form-field>

        <mat-form-field>
          <mat-label>Valor atual</mat-label>
          <input
            matInput
            currencyMask
            [(ngModel)]="stockService.stockSelected.currentValue"
            name="currentValue"
          />
        </mat-form-field>
      </div>

      <div class="return-value">
        <h2>Lucro e Prejuízo</h2>

        <div class="info">
          <span>Rentabilidade (R$)</span>
          <span>
            {{
              formatter.formatCurrency(
                stockService.stockSelected.currentValue -
                  stockService.stockSelected.purchaseValue
              )
            }}
          </span>
        </div>
        <mat-divider></mat-divider>
        <div class="info">
          <span>Rentabilidade (%)</span>
          <span>
            {{
              stockService.stockSelected.currentValue
                ? formatter.formatPercent(
                    (stockService.stockSelected.currentValue * 100) /
                      stockService.stockSelected.purchaseValue -
                      100
                  )
                : "0,00%"
            }}
          </span>
        </div>

        <div
          class="display"
          [ngClass]="
            stockService.stockSelected.currentValue -
              stockService.stockSelected.purchaseValue >
            0
              ? 'display-positive'
              : 'display-negative'
          "
        >
          <div
            class="display-container"
            [ngClass]="
              stockService.stockSelected.currentValue -
                stockService.stockSelected.purchaseValue >
              0
                ? 'display-container-positive'
                : 'display-container-negative'
            "
          >
            <span class="total">Total</span>
            <div>
              <span class="value">
                {{
                  formatter.formatCurrency(
                    stockService.stockSelected.currentValue -
                      stockService.stockSelected.purchaseValue
                  )
                }}
              </span>
              <span class="percentage">
                ({{
                  stockService.stockSelected.currentValue
                    ? formatter.formatPercent(
                        (stockService.stockSelected.currentValue * 100) /
                          stockService.stockSelected.purchaseValue -
                          100
                      )
                    : "0,00%"
                }})
              </span>
            </div>
          </div>
        </div>
      </div>

      <div class="action-buttons">
        <button mat-raised-button color="warn" (click)="drawer.toggle()">
          Cancelar
        </button>
        <button
          mat-raised-button
          color="primary"
          (click)="saveStock(); drawer.toggle()"
        >
          Salvar
        </button>
      </div>
    </div>
  </mat-drawer>

  <div class="stock-table">
    <div class="title">
      <h1>Swing Trade</h1>
      <button mat-raised-button color="primary" (click)="createStock()">
        Adicionar ativo
      </button>
    </div>

    <!--<app-stock-list [data]="items" [drawer]="drawer" />-->
  </div>
</mat-drawer-container>
